---
title: Smartsheet Live Data Connector

language_tabs:
  
toc_footers:

includes:

search: false
---

<% apiaccesstoken = "[Use API Token for SSO login](#connect-using-api-access-token-(for-sso-users))" %>

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-KW34LR"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KW34LR');</script>
<!-- End Google Tag Manager -->

# <span class="customTOCSectionHeading">Getting Started</span>

<aside class="notice">Last updated: 12/10/2015</aside>

# Overview

The Smartsheet Live Data Connector (also known as the Smartsheet ODBC Driver) provides industry-standard connectivity between Smartsheet and third-party analytics tools.  It enables business users to interact with and visualize data stored in Smartsheet using business analytics and data visualization software such as Tableau, Spotfire, QlikView / Qlik Sense, Excel and others.

<aside class="warning"><b>Note</b>: The Smartsheet Live Data Connector provides a <b>read-only</b> experience and is not able to write data into Smartsheet.</aside>
 
Benefits of using the Live Data Connector include, but not limited to, the following:

* Industry-standard ODBC-based connectivity to Smartsheet. The Connector is compatible with version 3.8 of the ODBC specification.
* Smartsheet-wide access control (ACL) is enforced and data access and retrieval via ODBC is subject to all Smartsheet's existing security mechanisms.
* Interact with Smartsheet data dynamically, using Smartsheet as a live data source.
* Create charts, graphs and other visualizations with data stored in one or more Smartsheet sheets or reports.

# Quick Start

This section provides a fast track to getting you up and running with the Smartsheet Live Data Connector as quickly as possible. 

</br>

<table>
	<tr>
		<td> <img class="table" src="images/quickStart/1.png"> </td>
		<td> <img class="table" src="images/quickStart/2.png"> </td>
		<td> <img class="table" src="images/quickStart/3.png"> </td>
	</tr>
	<tr>
		<td class="quickstart"> <a href="#download"><b>Download the installer</b></a></td>
		<td class="quickstart"> <b>Run the installer</b></td>
		<td class="quickstart"><b>Configure your software</b></td>

	</tr>
	<tr>
		<td> <img class="table" src="images/Screenshots/install.png"> </td>
		<td> <img class="table" src="images/Screenshots/install1.png"> </td>
		<td>
		 <li> <a href="#tableau-desktop">Tableau Desktop</a> </li>
		 <li> <a href="#tableau-server">Tableau Server</a> </li>
		 <li> <a href="#tibco-spotfire">Tibco Spotfire</a> </li>
		 <li> <a href="#qlik-sense">Qlik Sense</a> </li>
		 <li> <a href="#qlikview">QlikView</a> </li>
		 <li> <a href="#excel">Excel</a> </li> 
		</td>
	</tr>
</table>

</br>

<aside class="notice">After you've completed setup and configured the Live Data Connector with the software of your choice, we recommend reading through the <a href="#configuration">Configuration</a> section.</aside>

# Requirements

* Smartsheet Enterprise Plan and a user license 
* MSFT Windows 7, 8 or Windows Server 2012
* Tableau Desktop 8.2/8.3/9.x or Tableau Server 8.3.3/9.x
* QlikView 11.2, Qlik Sense 1.1
* Tibco Spotfire 6.x
* Excel 2010, 2013 - Data Connection Wizard, MSFT Query, Power Query

<aside class="notice"><b>Note</b>: In order to use the Smartsheet Live Data Connector with Tableau you will need to be running <b>Tableau Desktop Professional Edition</b>.</aside>

# Support

If you experience any difficulties, have questions or feature requests, please visit the [Smartsheet Help Center](http://help.smartsheet.com/). 

If you have a technical issue, please send a detailed message to [api@smartsheet.com](mailto:api@smartsheet.com) with the following information:

* Screenshot of the error message
* Exact steps to reproduce the issue
* Attach a copy of logs generated by the Live Data Connector (follow the steps in [this section](#enabling-logging-(optional)) to enable logging.)

# Download

Download the most recent installer:

<aside class="notice">If you are planning to use the Connector with Excel, get the one that matches your version of Microsoft Office (32 bit or 64 bit).</aside>

* [32 bit, version 1.1.26.1](https://s3-us-west-2.amazonaws.com/smartsheet-platform/smartsheet_ldc_setup_32bit_1.1.26.1_Signed.msi)
* [64 bit, version 1.1.26.1](https://s3-us-west-2.amazonaws.com/smartsheet-platform/smartsheet_ldc_setup_64bit_1.1.26.1_Signed.msi)

# <span class="customTOCSectionHeading">Configuration</span>

<aside class="notice">This section covers a number of advanced features and additional capabilties included with the Smartsheet Live Data Connector.</aside>

# Windows Proxy Configuration (optional)

Some organizations use a [proxy server](https://en.wikipedia.org/wiki/Proxy_server) to access web content.  If you are using a proxy to access web content, the Smartsheet Live Data Connector will use your proxy server as well. You can check your proxy settings from **Internet Options** in your Control Panel. 

To do so, select the **Connections** tab, and then click on **LAN settings** at the bottom of the window:

<aside class="notice">By default the Smartsheet Live Data Connector will use the Windows / Internet Explorer’s proxy settings for the currently logged-in user.</aside>

<img src="images/proxy/internetproperties.png" /></br></br>

… and if you have a proxy configured, you will see it in your LAN settings (example):

<img src="images/proxy/lansettings.png" /></br></br>

The Smartsheet Live Data Connector will use either the automatic configuration script in the **Automatic configuration** group box or the proxy server address in the **Proxy server** group box as valid proxy server configurations. 

<aside class="warning">Note: The Smartsheet Live Data Connector <b>will not</b> use the DHCP or DNS auto-discovery method due to poor performance in some network configurations (the <b>Automatically detect settings</b> checkbox).</aside>

If the Smartsheet Live Data Connector is running on a Windows Server where it is not impersonating a logged-in user (for example when it is running under the Tableau Server service) only the system default proxy settings will be used. Ask your Network Administrator for more information on [configuring Windows Server for proxy access](https://technet.microsoft.com/en-us/library/cc731131%28v=ws.10%29.aspx).

# Enabling logging (optional)

If you run into any issues with the Connector, we may ask you to send us your log file to help identify and address the problem.  Enabling logging simply creates a text file on your computer and logs the Connector activity.

<aside class="notice">Note: because the log files will capture the details of what exactly is getting retrieved from Smartsheet, some potentially confidential data - e.g. sheet names, column names, etc. - may be logged.</aside>

To enable logging, please locate the logging utility by navigating to:

1. **Start** > **Programs** > **Smartsheet Live Data Connector**
2. Click on **Enable Driver Logging**

<img src="images/Screenshots/StartMenu.png" /></br></br>

Check **Enable logging** and click on **Folder** to specify the log destination:

<img src="images/Screenshots/enableLogging.png" /></br></br>

Pick a destination folder and click **OK**:

<aside class="notice">Note: The easiest approach is to select your Desktop folder so you can easily find the log file later</aside>


<img src="images/Screenshots/destinationfolder.png" /></br></br>

Once the destination is selected, click **OK** to finish:

<img src="images/Screenshots/destinationselected.png" /></br></br>

# Configuring a Smartsheet DSN (optional)

<aside class="success">If you have already set up a Smartsheet ODBC Data Source Name you may <a href="#advanced-options-menu">skip to the next section</a>.</aside>

<aside class="notice">Some applications, like Tableau, allow using the Connector directly. Others require to first set up a Data Source in Windows.</aside>

If you need to set up a Data Source:

1. Navigate to **Start** > **Programs** > **Smartsheet Live Data Connector**
2. Run **ODBC Data Source Admin**

<img src="images/Screenshots/StartMenu.png" /></br></br>

Click **Add…** to add a data source:

<img src="images/Screenshots/addDSN.png" /></br></br>

Select **Smartsheet Live Data Connector** and click **Finish**:

<img src="images/Screenshots/ssldc.png" /></br></br>

…and then fill in the details.  If your Smartsheet account does not permit using email and password for login, you can use the [Use API Token for SSO login](#connect-using-api-access-token-(for-sso-users)) option instead. 

<img src="images/Screenshots/configuresmartsheetdsn.png" /></br></br>

# Advanced Options Menu

<aside class="notice">The Advanced Options menu provides controls to include additional row metadata and manage data conversion modes.</aside>

The menu can be accessed either at the time of using the Connector (e.g., from within Tableau):

<img src="images/Screenshots/selectadvancedoptions.png" /></br></br>

... or when setting up an ODBC Data Source:

<img src="images/Screenshots/odbcdataadminadvancedoptions1.png" /></br></br>

Click on the **Advanced options** link to open the menu:

<img src="images/Screenshots/AdvancedOptionsMenu.png" /></br></br>

The **Advanced Options** menu has options for including extended metadata (such as Gantt attributes, if present, outline level, and discussions text) as additional columns. It also provides controls for advanced features and logging.
 
**The following options are presented in this menu:**
 
* Optional Content - extended metadata as additional columns
* Enabling logging (similar to the option to enable logging in the Start menu)
* Report cache - auto refresh settings
* Data retrieval mode
* SQL table names
 
**Data retrieval mode has 3 options:**

<aside class="notice">The <b>Data retrieval mode</b> section only applies to Text/Number columns</aside>
 
* **Always return text** - returns all results as text
* Use **majority** rule - returns numeric results only if more than half the column inputs are numeric, discarding all non-numeric input
* Use **entirety** rule - returns numeric results only if 100% of the column inputs are numeric, otherwise returns all results as text
 
**The SQL table names section is available to shorten names. By default the full path is appended to the sheet name. Unchecking this option will cause only the sheet/report name to be returned.**

# Custom SQL Functions (optional)

In the Advanced Options menu, scroll down to the bottom of the **Optional content** list and you will see an **Enable custom SQL functions** checkbox:

<img src="images/Screenshots/customsqlfunctions.png" /></br></br>

Checking this option will enable the following SQL functions:


Function | Tableau Example
 ----|----
attachments_count() - *returns integer* | RAWSQL_INT('attachments_count(%1)',[_Rowlocator])
discussions_count() - *returns integer* | RAWSQL_INT('discussions_count(%1)',[_Rowlocator])
discussions_text() - *returns text* | RAWSQL_STR('discussions_text(%1)',[_Rowlocator])
parent_id() - *returns text* | RAWSQL_STR('parent_id(%1)',[_Rowlocator])
child_ids() - *returns text* (comma separated values) | RAWSQL_STR('child_ids(%1)',[_Rowlocator])
outline_level() - *returns integer* | RAWSQL_INT('outline_levle(%1)',[_Rowlocator])
sheet_id() - *returns text* | RAWSQL_STR('sheet_id(%1)',[_Rowlocator])
sheet_name() - *returns text* | RAWSQL_STR('sheet_name(%1)',[_Rowlocator])
predecessor_ids() - *returns text* (comma separated values) | RAWSQL_STR('predecessor_ids(%1)',[_Rowlocator])
predecessor_tasks() - *returns text*| RAWSQL_STR('predecessor_tasks(%1)',[_Rowlocator])
duration_seconds() - *returns double* | RAWSQL_REAL('duration_seconds(%1)',[_Rowlocator])

# Column Type Conversion Logic

<aside class="notice">Smartsheet allows for any data to be stored in a cell despite the column type.</aside>

The connector uses the following logic to process and convert Smartsheet data:

* **Text/Number**: The Text/Number column defaults to the majority rule. This means that numeric values are returned if more than half of the column inputs are numeric. All other values are discarded. This rule can be changed in the [Advanced Options](#advanced-options-menu) section during login.

* **Date, time**, and **datetime**: Date, time, and datetime columns have a storage class of TEXT, which means they are not converted to a date until a query is ran.
 
* **Picklists**: Picklists probe for types but they use a precise rule (100%). So, one text string in a list of integers would cause the picklist to display text. All of the state picklists resolve to text (5-State Signal, 6-State Hearts, etc..).
 
* **Checkbox**: Checkbox (or any on/off column) values are stored as a Boolean and uses an integer storage class. Any text data in a checkbox column would be lost. An exception to this rule would be a list to what equates to Boolean data (on/off, true/false, 0/1) i.e. Stars and Flags. These would be stored in a Boolean and the same rules apply.



# <span class="customTOCSectionHeading">Usage</span>

<aside class="notice">The Usage section provides resources and instructions for connecting some of the most popular pieces of software with Smartsheet.</aside>

# Tableau Desktop

<aside class="notice">This walkthrough uses Tableau Desktop version 9, the menus and options for Tableau Desktop version 8 are slightly different.</aside>

Connect to the Smartsheet Data Source by choosing the **To a server** > **Other Databases (ODBC)** option.  If you do not see the ODBC option listed here, click on the **More Servers…** and choose it from the list from additional options:

<img src="images/Screenshots/othersourcesodbc.png" /></br></br>

Under **Connect Using** pick **Driver**, and then select **Smartsheet Live Data Connector** from the Driver drop-down menu:

<img src="images/Screenshots/selectdsn.png" /></br></br>

… and click **Connect**.

## Connect using Email Address and Password

Connect to Smartsheet by entering your Smartsheet credentials into the **Smartsheet Login** dialog box:

<img src="images/Screenshots/sslogin.png" /></br></br>

## Connect using API Access Token (for SSO users)

<aside class="notice">If your Smartsheet account requires single sign-on (e.g., via SAML, Google or MSFT Azure AD) and does not allow logins using email and password, you can use a Smartsheet API Access Token instead.</aside>
 
First, you need to create a token - it's easy with just a couple of clicks.

In Smartsheet, navigate to **Account** > **Personal Settings**:

<img src="images/Screenshots/ssSettings.png" /></br></br>

In Personal Settings, select **API Access** and click on **Generate new access token**:

<img src="images/Screenshots/generatenewaccesstoken.png" /></br></br>

Give the new token an arbitrary, descriptive name and click **OK**:

<img src="images/Screenshots/nameToken.png" /></br></br>

<aside class="warning">Make sure you copy the token before you close the window because you won't be able to view the token again (for security reasons).</aside>

<img src="images/Screenshots/copyToken.png" /></br></br>

Now go back to your **Smartsheet Login** window and click on the **Use API token for SSO login** option:

<img src="images/Screenshots/useAPIToken.png" /></br></br>

… and paste your access token:

<img src="images/Screenshots/pasteToken.png" /></br></br>

Upon successful login, confirm connection information and click **OK**:

<img src="images/Screenshots/confirmConnection.png" /></br></br>

## Creating Workbooks and Reports

Browse or search Sheets.  You can search by Sheet or Report name, or by any portion of their path (name of parent Workspace or Folder).

<aside class="notice">Note: The search feature is <b>case-sensitive</b></aside>

<img src="images/Screenshots/searchSheets.png" /></br></br>

Then drag and drop each Sheet or Report you need to the upper right pane:

<img src="images/Screenshots/dragAndDrop.png" /></br></br>

If you are using multiple sheets or reports, and they have columns in common, Tableau will try automatically figure out how to map the selected Sheets and will create a default relationship between them.  You can modify the type of relationship (JOIN) at this time.

 Once you are done, click **Go to Worksheet** at the bottom of the application to proceed to the visualization design step:

<img src="images/Screenshots/goToWorksheet.png" /></br></br>

The next step is to design and configure your report:

<img src="images/Screenshots/design.png" /></br></br>

Finally, use Tableau Dashboard to create a compelling visual representation of the data:

<aside class="notice">Note: If you have any questions relating to using Tableau, please contact Tableau directly.</aside>

<img src="images/Screenshots/visual.png" /></br></br>

<aside class="success">If you need to publish your work to Tableau Server, you can proceed to <a href="#tableau-server">this section</a>.</aside>

## Re-opening Saved Workbooks

Tableau Desktop does not save login credentials by design (for security reasons), so the next time you launch Tableau Desktop and re-open a previously saved workbook, in Tableau 8, you will see an error message:

<img src="images/Screenshots/tableau8Error.png" /></br></br>

Click **Yes** and re-enter your Smartsheet password.  Or, if you are using an [API Access token](#connect-using-api-access-token-(for-sso-users)) to connect, paste the token into the password field instead:

<img src="images/Screenshots/editConnection.png" /></br></br>

In Tableau 9 you will see a different message, re-enter your login credentials then click **OK**. Or, if you are using an [API Access token](#connect-using-api-access-token-(for-sso-users)) to connect, paste the token into the password field instead.

<img src="images/Screenshots/reenteruserandpassword.png" /></br></br>

# Tableau Server

<aside class="success">This section covers publishing workbooks to a server using Tableau. If you do not need to publish workbooks or do not have a Tableau server, you may skip this section.</aside>

## Installation

The process for installing the Smartsheet Live Data Connector is the same for both server and desktop. You can visit the [Download](#download) section to find the latest installer packages.

<aside class="notice"><b>Note</b>: If you have multiple server nodes, the Smartsheet Live Data Connector will need to be installed on each one. We also recommend installing both the 32 and 64 bit versions as they do not conflict with one another.</aside>

## Publishing Workbooks to Tableau Server

A typical Tableau Server workflow starts with [creating a workbook / report in Tableau Desktop](#creating-workbooks-and-reports).  Once you create a workbook in Tableau Desktop, you can publish it to a Tableau Server for others to use.

Open the **Server** menu option and select **Publish Workbook…**:

<img src="images/Screenshots/publishworkbook.png" /></br></br>

If you are not already logged in to your Tableau Server, you will be prompted to do so. 

Enter your server:

<aside class="notice">For information on how to access your Tableau Server, please contact your organization's IT / Tableau administrator.</aside>

<img src="images/Screenshots/enterServer.png" /></br></br>

Then enter your login credentials:

<img src="images/Screenshots/serverSignin.png" /></br></br>

Once logged in, at the next step you will have an opportunity to name the workbook, specify where to save the new workbook on the server, and manage the permissions and access for the published workbook.  In terms of access to workbook data, you have two options: 

1. Have users provide their own credentials (which requires they have a Smartsheet login and have permissions in Smartsheet to access the data you included in your workbook).

2. Access the data you have published without having to provide Smartsheet credentials.

**The second option is likely to be the most common one**.  Tableau Server makes it possible to store your login credentials with your published workbook.  To choose this option, click the **Authentication…** button:

<img src="images/Screenshots/publishtoserver.png" /></br></br>

At the next step, you may have to scroll to the right to see the Authentication options:

<img src="images/Screenshots/scrollRight.png" /></br></br>

Finally, in the Authentication dropdown, select **Embedded password**:

<img src="images/Screenshots/embeddedPassword.png" /></br></br>

To save and finish, click **OK**.

# Tibco Spotfire

<aside class="notice">Tibco Spotfire is supported as of version 1.1 of the Live Data Connector, however, the Spotfire Web Player is <b>not</b> supported at this time.</aside>

<aside class="warning">
<b>Note</b>: to use Tibco Spotfire with the Live Data Connector, you must first:

<ol>
<li>
<b>Install the same version of the Live Data Connector as the version of Spotfire you are using</b> (i.e. if you are using the 64 bit version of Spotfire, you must install the 64 bit version of the Live Data Connector). You can find download links <a href="#download">here</a>.
</li></br>

<i>If you have the wrong version of the driver installed, you will need to:</i>

<ul>
<li>
<b>Uninstall</b> the current Live Data Connector driver.
</li>
<li>
<b>Reinstall</b> the correct version of the driver.</i>
</li>
</ul>
</br>

<li>
<a href="#configuring-a-smartsheet-dsn-(optional)">Configure a Data Source</a>.
</li>
</ol>
</aside>

*Spotfire installation instructions can be found [here](http://spotfire.tibco.com/learn/spotfire-desktop-quickstart#installing-spotfire-desktop). Additional resources for using Spotfire can be found [here](http://spotfire.tibco.com/learn/spotfire-desktop-quickstart#getting-started-with-spotfire).*

</br>

Launch Spotfire and then navigate to **Add Data** > **Add Data Connection** > **Other**:

<img src="images/Spotfire/AddData.png" /></br></br>

Click on **Add** then select **Database…** at the bottom of the list:

<img src="images/Spotfire/addOtherDatabase.png" /></br></br>

Choose **Odbc Data Provider** then click **Configure…**:

<img src="images/Spotfire/configureOdbc.png" /></br></br>

Select the [DSN you configured earlier](#configuring-a-smartsheet-dsn-(optional)). Fill in your Smartsheet credentials to log in.  Or, if you are using an [API Access token](#connect-using-api-access-token-(for-sso-users)) to connect, paste the token into the password field instead:

<img src="images/Spotfire/logIntoDsn.png" /></br></br>

Select a Table and all columns needed, set a Data Source Name, then click **OK**:

<img src="images/Spotfire/dataSourceName.png" /></br></br>

Select the Data table you just set up and click **OK** to import the data (the Name will be the same as the **Data source name** you entered in the last step):

<img src="images/Spotfire/finalizeDataSource.png" /></br></br>

Finally, use Spotfire to create a nice visualization of the data:

<aside class="notice">For any questions related to using Spotfire, you can visit their support page <a href="http://spotfire.tibco.com/learn/spotfire-desktop-quickstart#getting-started-with-spotfire">here</a>.</aside>

<img src="images/Spotfire/visual.png" /></br></br>



# Qlik Sense

<aside class="notice">Qlik Sense installation instructions can be found <a href="https://community.qlik.com/docs/DOC-7140">here.</a></aside>
<aside class="warning">To use Qlik Sense with the Live Data Connector, you must <a href="#configuring-a-smartsheet-dsn-(optional)">configure a Data Source</a> first.</aside>

Open up Qlik then click on **Create a new app** on the dialog that appears

<img src="images/QlikSense/5openqlik.png" /></br></br>

Enter a name for your app and click **Create**:

<img src="images/QlikSense/6createApp.png" /></br></br>

Click on **Open app**:

<img src="images/QlikSense/7openApp.png" /></br></br>

Click on **Add data**:

<img src="images/QlikSense/8addData.png" /></br></br>

Then click on **Connect my data**, then click **ODBC**:

<img src="images/QlikSense/9ODBC.png" /></br></br>

Create a new connection by selecting the [DSN you configured earlier](#configuring-a-smartsheet-dsn-(optional)).  Fill in your Smartsheet credentials to log in.  Or, if you are using an [API Access token](#connect-using-api-access-token-(for-sso-users)) to connect, paste the token into the password field instead:

<img src="images/QlikSense/10userLogin.png" /></br></br>

Select the data you want, then click **Load and finish**:

<img src="images/QlikSense/11addSheetsData.png" /></br></br>

After the data is loaded, click on **Close**:

<img src="images/QlikSense/12dataSuccessful.png" /></br></br>

Then click on the new data sheet you just created:

<img src="images/QlikSense/14openSheet.png" /></br></br>

Finally, use the data to create your dashboard in Qlik Sense:

<img src="images/QlikSense/15visual.png" /></br></br>

# QlikView

<aside class="warning">To use QlikView with the Live Data Connector, you must <a href="#configuring-a-smartsheet-dsn-(optional)">configure a Data Source</a> first.</aside>

Open up ClickView and navigate to **File** > **New**:

<img src="images/QlikView/fileNew.png" /></br></br>

After the **Getting Started Wizard:** dialog starts, click the **X** in the upper right-hand corner:

<img src="images/QlikView/gettingStartedWizard.png" /></br></br>

After the dialog is closed, click on **File** again, then click on **Edit Script…**:

<img src="images/QlikView/editScript.png" /></br></br>

On the next screen, select **ODBC** in the **Database** dropdown, then click on **Connect…** (you can click on **Select…** as well, they open the same dialog box):

<img src="images/QlikView/connectToDatabase.png" /></br></br>

On the next dialog, select the Data Source you set up (If it doesn’t show, click the **Show User DSNs** checkbox). Fill in your Smartsheet credentials to log in.  Or, if you are [using an API Access token to connect](#connect-using-api-access-token-(for-sso-users)), paste the token into the password field instead:

<img src="images/QlikView/logIntoSsDsn.png" /></br></br>

Click on **Select**:

<img src="images/QlikView/selectSheet.png" /></br></br>

Select the Tables and Columns you would like then click **OK**:

<img src="images/QlikView/selectTablesAndColumns.png" /></br></br>

After you’re finishing adding tables and your script is ready, click **OK**:

<img src="images/QlikView/finishedScript.png" /></br></br>

Your data is now loaded, you can begin making graphs and charts:

<img src="images/QlikView/createGraphs.png" /></br></br>

If you add new data to your script after the initial setup, you’ll need to be sure you reload the script. 

Click on **File** > **Reload**:


<img src="images/QlikView/reloadScript.png" /></br></br>

# Excel

This section covers the various ways to use the Smartsheet Live Data Connector with Excel. 

<aside class="warning"><b>Note</b>: Excel does not provide a seamless way to save credentials within a workbook and can be unreliable. If you are looking to share data and analytics with others, Excel is not recommended.</aside>

<aside class="notice">If you choose to use Excel and need to share your workbooks, it is recommended that you use <a href="#excel---microsoft-query">Microsoft Query</a>. Because of the way data is created and stored, the <a href="#excel---data-connection-wizard">Data Connection Wizard</a> is <b>not</b> supported for saving credentials.</aside>

## Excel - Data Connection Wizard

<aside class="warning">To use the Data Connection Wizard, you must <a href="#configuring-a-smartsheet-dsn-(optional)">configure a Data Source</a> first.</aside>

Open the Data Connection Wizard by navigating to **Data** > **Get External Data** > **From Other Sources**:

<img src="images/ExcelDataConnectionWizard/1.png" /></br></br>

Select **ODBC DSN** and click **Next**:

<img src="images/ExcelDataConnectionWizard/2selectODBC.png" /></br></br>

Select the name of the DSN you created earlier, and click **Next**:

<img src="images/ExcelDataConnectionWizard/3selectSSDSN.png" /></br></br>

When prompted, fill in your Smartsheet login credentials.  If your Smartsheet account requires a single sign-on and you are unable to use email and password for login, you can use the <%= apiaccesstoken %> option instead and paste your API token into the password field:

<img src="images/ExcelDataConnectionWizard/4ssLogin.png" /></br></br>

Once connected to Smartsheet, select your sheet or report and click **Finish**:

<img src="images/ExcelDataConnectionWizard/5selectSheet.png" /></br></br>

Finally, specify the destination for the imported data:

<img src="images/ExcelDataConnectionWizard/6specifyDestination.png" /></br></br>

## Excel - Microsoft Query

<aside class="warning"><b>IMPORTANT</b>: Make sure that the type of Smartsheet ODBC Driver (32-bit or 64-bit) installed on your computer matches the type of Microsoft Office installed (32-bit or 64-bit). <a href="#download">Click here</a> to download the installer packages.</aside>

<aside class="notice">It is possible to create new data sources right in Microsoft Query.  We recommend, however, that you <a href="#configuring-a-smartsheet-dsn-(optional)">Configure a Data Source</a> prior to using Microsoft Query.</aside>

Once a DSN has been configured, navigate to Microsoft Query by navigating to **Data** > **From Other Sources** > **From Microsoft Query**:

<img src="images/ExcelMSQuery/1selectMSQuery.png" /></br></br>

Select the Data Source you created earlier, then click **OK**:

<img src="images/ExcelMSQuery/2selectDataSource.png" /></br></br>

When prompted, fill in your Smartsheet login credentials.  If your Smartsheet account requires a single sign-on and you are unable to use email and password for login, you can use the <%= apiaccesstoken %> option instead and paste your API token into the password field:

<img src="images/ExcelMSQuery/3ssLogin.png" /></br></br>

Once connected, select your desired sheets or reports:

<img src="images/ExcelMSQuery/4selectSheets.png" /></br></br>

<aside class="warning">The next two steps (not pictured here) let you filter and sort your data. <b>It is recommended that you do not use filtering here</b> but instead use Microsoft Excel filtering. Microsoft Query filtering frequently generates invalid SQL code.</aside>

Specify the destination for your data:

<img src="images/ExcelMSQuery/5setDestination.png" /></br></br>

Select how you want to view the data:

<img src="images/ExcelMSQuery/6importData.png" /></br></br>

### Saving Credentials

<aside class="warning"><b>Note</b>: This method is provided as a potential solution for saving credentials in an Excel workbook. While we have provided this method, <b>saving credentials and sharing workbooks in Excel is not recommended or supported by Smartsheet</b>.</aside>

To save credentials, click on the **DATA** tab, then click on **Connections**:

<img src="images/credentials/dataConnections.png"></br></br>

Choose the Connection for your query, then click on **Properties**:

<img src="images/credentials/workbookConnections.png"></br></br>

<aside class="notice"><b>Note</b>: In order to save your credentials, you'll need to generate an <a href="http://smartsheet-platform.github.io/api-docs/#generating-access-token">API access token</a>. <b>Using your Smartsheet password is not recommended as it may be visible to others</b>.</aside>

</br>

Click on the **Definition** tab, then check the **Save password** option. 

After you've checked the option to save your password, you'll want to copy the following string to the end of the **Connection String** (Replacing `API_TOKEN` with the [API access token](http://smartsheet-platform.github.io/api-docs/#generating-access-token) you generated): 

`PWD=API_TOKEN`

Finally, click on **OK**:


<img src="images/credentials/savePassword.png"></br></br>

<aside class="notice">When a workbook is shared with a user for the first time, it may ask them to enter their Smartsheet username & password. <b>You can cancel the login process when the dialog appears, then refresh the connection manually</b>.</aside>

<img src="images/credentials/ssLogin.png"></br></br>

<img src="images/credentials/refreshAll.png"></br></br>




## Excel - Power Query

<aside class="notice">Power Query does not provide a user-friendly interface to select your sheets and build your query.  So, first you need to use Microsoft Query to build your query.</aside>

Follow the [earlier instructions for Microsoft Query](#excel---microsoft-query), but instead of returning data to Excel, select **View data or edit data query in Microsoft Query**:

<img src="images/ExcelMSQuery/5setDestination.png" /></br></br>

Once in query editor, click on **SQL** and copy the SQL statement in the window that opens:

<img src="images/ExcelPowerQuery/1sql.png" /></br></br>

Now, launch Power Query from the main Excel menu and select **From other sources** > **From ODBC**:

<img src="images/ExcelPowerQuery/2powerQuery.png" /></br></br>

At the next step, paste the string below into **Connection string**, and paste the query you copied / saved from an earlier step into **SQL Statement**:

`Driver={Smartsheet Live Data Connector}`

<img src="images/ExcelPowerQuery/3fromODBC.png" /></br></br>

Finally, enter your Smartsheet credentials when prompted:

<img src="images/ExcelPowerQuery/4ssCredentials.png" /></br></br>

# <span class="customTOCSectionHeading">FAQ</span>

<span class="faq">The following questions are answered in this section:</span>


* <a href="#q1">Why am I seeing this error - "Unexpected error", when expanded says that "ODBC is not enabled for your account"?</a>
* <a href="#q2">My date columns contain mixed milestone names (text) and dates, but on import into Tableau all text data is lost. How can I see this information?</a>
* <a href="#q3">Does my Smartsheet data need to be formatted in a certain way to be compatible with Tableau?</a>
* <a href="#q4">When I use Tableau Desktop, why do I have to re-enter my Smartsheet credentials every time I re-open Tableau?</a>
* <a href="#q5">Why am I getting an “invalid username or password” error when trying to re-open a previously saved Tableau Desktop workbook?</a>
* <a href="#q6">What is the max number of tables that the Smartsheet Live Data Connector will support in a join?</a>
* <a href="#q7">What SQL dialect does the Smartsheet Live Data Connector support?</a>
* <a href="#q8">Why aren’t the Tableau DATEDIFF and DATEADD functions working correctly?</a>
* <a href="#q9">Why doesn't Tableau’s Fiscal Calendar Start functionality work correctly?</a>
* <a href="#q10">I tried publishing a Smartsheet-based Workbook and got a message that the functions TODAY() and NOW() will work differently because the server and Smartsheet are in the different timezones.</a>
* <a href="#q11">My Smartsheet data does not appear to refresh on Tableau Server.</a>
* <a href="#q12">I am using Tableau Desktop with a datasource published on my Tableau Server, but getting an error “Unknown data source class 'SQLite’”.</a>
* <a href="#q13">I am seeing “Tableau identified limitations…” warning message.</a>
* <a href="#q14">How do I get Excel to Auto-Refresh Smartsheet Data?</a>
* <a href="#q15">I am getting an error message trying to configure or delete a DSN - “The setup routines for the … could not be found. Please reinstall the driver.”</a>
* <a href="#q16">I am getting an error message when attempting to open a saved workbook - "Invalid username or password for data source"</a></br></br></br></br>


<span class="faq" id="q1">Why am I seeing this error - "Unexpected error", when expanded says that "ODBC is not enabled for your account"?</span>

<img src="images/FAQ/unexpectedError.png" /></br></br>

<img src="images/FAQ/unexpectedError2.png" /></br></br>

This is because ODBC access has not been enabled for your Smartsheet account. Please see the [Requirements](#requirements) section to ensure your account is eligible to use the Live Data Connector.

<aside class="notice">If you meet all the requirements and still receive this error please visit the <a href="#support">Support</a> section for information on reaching our support team.</aside>

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q2">My date columns contain mixed milestone names (text) and dates, but on import into Tableau all text data is lost. How can I see this information?</span>

Date and Time columns have a storage class of text in the Live Data Connector. This means that they are plain text strings until imported into Tableau or other ODBC applications. If you wish to see the non-date/time content of these columns, you must modify the Tableau column type prior to import. You can do this by a right clicking on the calendar icon in the Tableau table selection screen and selecting the **String** type. All cell contents will now be displayed as raw, unformatted text.

<img src="images/FAQ/lostDataTableau.png" /></br></br>

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q3">Does my Smartsheet data need to be formatted in a certain way to be compatible with Tableau?</span>

Spreadsheet data may require some formatting to work with Tableau.  Tableau has created a guide for Excel users, and much of it apply to Smartsheet as well because of similarities in how data may be structured in Excel and Smartsheet.  See [Preparing your Excel data for Tableau](http://kb.tableau.com/articles/knowledgebase/preparing-excel-files-analysis) knowledge base article.

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q4">When I use Tableau Desktop, why do I have to re-enter my Smartsheet credentials every time I re-open Tableau?</span>

Tableau Desktop does not save user login credentials by design, as a security precaution.  It is a feature of Tableau Desktop, not a feature of the Smartsheet Live Data Connector.  To re-open previously saved Tableau Desktop workbooks, see [this section](#re-opening-saved-workbooks).

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q5">Why am I getting an "invalid username or password" error when trying to re-open a previously saved Tableau Desktop workbook?</span>

<img src="images/FAQ/invalidUsername.png" /></br></br>

Please see [this FAQ item](#q4).

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q6">What is the max number of tables that the Smartsheet Live Data Connector will support in a join?</span>

The Smartsheet Live Data Connector will support up to 64 tables (sheets) in a single join.

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q7">What SQL dialect does the Smartsheet Live Data Connector support?</span>

The Smartsheet Live Data Connector uses an implementation of SQLite to locally store and query Smartsheet sheets and reports. As such, the Live Data Connector can interpret native SQL as understood by SQLite. The SQL syntax used by SQLite is well documented on the SQLite website: [https://www.sqlite.org/lang.html](https://www.sqlite.org/lang.html). In addition to the SQLite core functions [https://www.sqlite.org/lang_corefunc.html](https://www.sqlite.org/lang_corefunc.html), the Live Data Connector also supports a variety of functions which expose sheet, column and cell metadata through native SQL. Those functions are described above.

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q8">Why aren't the Tableau DATEDIFF and DATEADD functions working correctly?</span>

When used with the Smartsheet Live Data Connector, Tableau `DATEDIFF` and `DATEADD` functions will not work correctly and will return null or another unusable result.  This is a known Tableau issue when used in conjunction with certain types of ODBC drivers.  The workaround is to define alternative date calculation functions in Tableau and use them instead.  Here is how to do this:

1. Open an existing workbook that's connected to Smartsheet via the Smartsheet Live Data Connector.
2. Navigate to the Worksheet view.
3. Right-click anywhere in the Data pane and select "Create Calculated Field".

<img src="images/FAQ/dateDiffdateAdd.png" /></br></br>

1. Provide an arbitrary name for your new field.  In this example we adding 15 days to an already existing date - hence calling it "My15DayAdd".  
2. Then in the Functions column select Tableau's `RAWSQL_DATE` function.  
3. Finally, In the Formula window type the formula `RAWSQL_DATE(“date(%1, ‘+15 day’)”, [DateField])` where `DateField` should be replaced by your column name:

<img src="images/FAQ/calculatedField.png" /></br></br>

You can now use this calculated field anywhere you’d use the `DATEADD` calculation. For example, in the screenshot below the original date of September 22, 2010 becomes a `DATEADD` date of October 7, 2010 (month wrap) after our calculation is applied:

<img src="images/FAQ/calculatedAnywhere.png" /></br></br>

If you are interested in the `DATEDIFF` calculation, follow the same steps, but this time use a `RAWSQL_INT` function as follows: 

`RAWSQL_INT("(strftime('%s',%2) - strftime('%s',%1))/86400", [StartDateField], [EndDateField])` 

Replace `StartDateField` and `EndDateField` with your actual columns:

<img src="images/FAQ/dateDiffCalc.png" /></br></br>

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q9">Why doesn't Tableau's Fiscal Calendar Start functionality work correctly?</span>

Any time I select a different fiscal year start month, it loses the year and quarter data for any month after the start month, through the end of the calendar year.  For example, if I choose August as the start of the fiscal year, the months of August through December show Null values for year and quarter.  January through July, however, show up correctly.

When communicating with the Smartsheet Live Data Connector, Tableau expects (as an example) that if you ask for the 15th month of 2014 that the Connector will return a date of the 3rd month of 2015. The Connector's date function, however, sees the 15th month as a bad value and returns NULL instead.  To work around this limitation, create a calculated field in Tableau:

1. Right click anywhere in the Data pane and select **Create Calculated Field**
2. Let's call it **FY Order Date**
3. In the Functions column select `RAWSQL_DATE`
4. Then in the Formula window type `RAWSQL_DATE("date(%1, '+6 month'), [Order Date])`, where `Order Date` should be replaced with the name of the date column you will use from your table.  

In this example the Fiscal Year starts on July 1st - hence '`+6 month`'.  If your Fiscal Year starts on a different month, you would need to adjust accordingly. For instance, if it starts in March, your calculation should say ‘`+2 month`’.

The result should look like this:

<img src="images/FAQ/fiscalCalendar.png" /></br></br>

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q10">I tried publishing a Smartsheet-based Workbook and got a message that the functions TODAY() and NOW() will work differently because the server and Smartsheet are in the different timezones.</span>

Tableau appears to be returning incorrect information when executing the `NOW()` function, and there appear to be a number of [online forum posts](http://community.tableau.com/thread/118197?start=0&tstart=0) confirming this.

Luckily, as with `DATEADD` and `DATEDIFF` we can modify these calculations to return UTC or local time. The `NOW()` UTC function is `RAWSQL_DATETIME("datetime('now')")`. And the `NOW()` local time function is `RAWSQL_DATETIME("datetime('now', 'localtime')")`.

The way most other Tableau users address this is by picking a common time zone and modifying the calculations to always use that time zone. **Our recommendation is to replace `NOW()` with your own function that returns UTC if you need to be consistent across time zones** (all other Smartsheet dates will also get returned in UTC). 

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q11">My Smartsheet data does not appear to refresh on Tableau Server.</span>

There is a known issue with Tableau Server prior to version 8.3.3 where the manual refresh (using F5) does not refresh any data from Smartsheet. The issue has been addressed in Tableau Server 8.3.3.

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q12">I am using Tableau Desktop with a datasource published on my Tableau Server, but getting an error "Unknown data source class 'SQLite'".</span>

There is a known issue with Tableau and Smartsheet Live Data Connector where Tableau Desktop is not able to use a Smartsheet ODBC-based data source published on a Tableau Server.  We are working with Tableau to develop a resolution.  Here are the steps to reproduce the error:

1. In Tableau Desktop, connect to a data source using **Connect Using Driver**.
2. Once in a Workbook, select the Data menu dropdown and then **Publish to Server…**
3. Log in to Tableau Server, change the Authentication to **Embedded Password** and publish data source.
4. Close and restart Tableau Desktop.
5. At the Connect to data screen, select **Tableau Server** (1st selection in the **On a server** category).
6. Log back into Tableau Server, and you’ll see the data source there.
7. Select the data source and you’ll get the following message: **Unknown data source class 'SQLite'**

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q13">I am seeing "Tableau identified limitations…" warning message.</span>

The Smartsheet Live Data Connector comes with a Tableau configuration file designed to optimize the Tableau integration experience.  The file gets installed into C:\My Documents\My Tableau Repository\Datasources directory and is called "smartsheet.tdc".
 
If for some reason Tableau is not able to find this file, you will see the following warning:

<img src="images/FAQ/tableauLimitations.png" /></br> 

This may happen for one of two reasons:

1. The Smartsheet Live Data Connector was installed before Tableau was installed, so the .tdc file was never copied to the Tableau directory because it didn't exist at the time.

2. Both 32-bit and 64-bit Connectors were installed and then one of them was uninstalled, removing the .tdc file.
 
**In both instances, the solution is to uninstall your Smartsheet Live Data Connector(s) and do a clean install of the Connector**, insuring that the .tdc file is now installed into the Tableau directory.

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q14">How do I get Excel to Auto-Refresh Smartsheet Data?</span>

<aside class="notice">You can schedule a data refresh on specific intervals in Excel.</aside>

To start, navigate to **Data** > **Refresh All** > **Connection Properties…**

<img src="images/FAQ/excelConnectionProperties.png" /></br></br>

After that, a dialog will open with several settings for refreshing. After you’ve finished setting the options to your liking, click **OK**:

<img src="images/FAQ/excelAutoRefresh.png" /></br></br>

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q15">I am getting an error message trying to configure or delete a DSN - "The setup routines for the … could not be found.  Please reinstall the driver."</span>

If you removed the Live Data Connector from your computer, or have upgraded it from version 1.0.20.3 (or earlier when it used to be called Smartsheet ODBC Driver), but still have Data Source Names (DSNs) set up with the old driver, you will not be able to configure or delete them.

When you attempt to configure or delete a DSN set up for an ODBC driver that has been removed from your computer, you will receive the following error message:

<img src="images/FAQ/ODBCerror.png" /></br></br>

Please follow the instructions described in [this online post](http://superuser.com/questions/713258/how-to-remove-odbc-data-source-if-driver-is-removed) to remove any references to the old driver.

First, click **Start**, type **regedit** and launch the Windows registry editor:

<img src="images/FAQ/regedit.png" /></br></br>

If your DSN is a **user** DSN (most likely) configured for a 64-bit driver, navigate to `HKEY_LOCAL_MACHINE\SOFTWARE\ODBC\ODBC.INI` and delete the data source key under `ODBC.INI` and the entry under `ODBC.INI\ODBC Data Sources:`

<img src="images/FAQ/registryeditor.png" />

[Back to FAQ](#faq)</br></br></br></br>

<span class="faq" id="q16">I am getting an error message when attempting to open a saved workbook - "Invalid username or password for data source"</span>

This error is likely caused by character limitations in Tableau. Because of the way data is passed in Tableau when a workbook is re-opened, the following characters cannot be used in your password:

`{} ; =`

If you have any of these characters in your password, you will need to change it and remove them.

<img src="images/FAQ/password.png"> </br>

[Back to FAQ](#faq)</br></br></br></br>


